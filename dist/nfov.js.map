{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 3b8a2fb7fbe2c62954da","webpack:///./src/handlers/basic.js","webpack:///./src/index.js"],"names":["handler","nfov","agents","targets","callback","each","eachAgent","_agent","agent","eachTarget","_target","target","targetInRange","targetInFOV","targetIsVisible","objs","Array","isArray","forEach","obj","fixPrecision","number","precision","Math","round","parseAngle","angle","isDegrees","isClockwise","PI","basicObject","x","position","Error","y","body","width","height","anchor","origin","agentObj","distance","getDistance","direction","maxAngle","getAngle","RADIANS","getAngleUnit","DEGREES","getOrientation","CLOCKWISE","rotation","angleDiff","angle1","angle2","halfCircle","fullCircle","diff","makeRay","tileSize","delta","abs","over","floor","current","step","point","next","dx","dy","sqrt","angle2Target","atan2","grid","getGrid","getTileSize","acceptableTiles","getAcceptableTiles","rayCast","tile","indexOf","module","exports","basicHandler","require","config","Object","assign","angleUnit","orientation","COUNTERCLOCKWISE","setDistance","setAngle","setAngleUnit","setOrientation","setGrid","setTileSize","setAcceptableTiles","setHandler","prototype","unit","widthOrObj","tiles","slice","getHandler","detect"],"mappings":"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","file":"nfov.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"nfov\"] = factory();\n\telse\n\t\troot[\"nfov\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3b8a2fb7fbe2c62954da","const handler = function handler (nfov, agents, targets, callback) {\r\n  handler.each(agents, function eachAgent (_agent) {\r\n    const agent = handler.agent(nfov, _agent)\r\n\r\n    handler.each(targets, function eachTarget (_target) {\r\n      const target = handler.target(nfov, _target)\r\n\r\n      if (handler.targetInRange(nfov, agent, target) &&\r\n          handler.targetInFOV(nfov, agent, target) &&\r\n          handler.targetIsVisible(nfov, agent, target)) {\r\n        callback(_agent, _target)\r\n      }\r\n    })\r\n  })\r\n}\r\n\r\nhandler.each = function each (objs, callback) {\r\n  if (Array.isArray(objs)) {\r\n    objs.forEach(function (obj) {\r\n      handler.each(obj, callback)\r\n    })\r\n  } else {\r\n    callback(objs)\r\n  }\r\n}\r\n\r\nhandler.fixPrecision = function fixPrecision (number) {\r\n  const precision = 10000000000\r\n  return Math.round(number * precision) / precision\r\n}\r\n\r\nhandler.parseAngle = function parseAngle (angle, isDegrees, isClockwise) {\r\n  angle = isDegrees === true ? angle * Math.PI / 180 : angle\r\n  angle = angle >= 0 ? angle : angle + Math.PI * 2\r\n  angle = isClockwise === true && angle > 0 ? Math.PI * 2 - angle : angle\r\n  return angle\r\n}\r\n\r\nhandler.basicObject = function basicObject (nfov, obj) {\r\n  if (obj.x == null && obj.position == null) {\r\n    throw new Error('Object position not found')\r\n  }\r\n\r\n  const position = {\r\n    x: obj.x,\r\n    y: obj.y\r\n  }\r\n\r\n  const body = {\r\n    width: obj.width,\r\n    height: obj.height\r\n  }\r\n\r\n  const anchor = {\r\n    x: 0.5,\r\n    y: 0.5\r\n  }\r\n\r\n  // phaser | pixi\r\n  if (obj.position != null) {\r\n    position.x = obj.position.x\r\n    position.y = obj.position.y\r\n  }\r\n\r\n  // phaser\r\n  if (obj.body != null && obj.body.width != null) {\r\n    body.width = obj.body.width\r\n    body.height = obj.body.height\r\n  }\r\n\r\n  // phaser | pixi\r\n  if (obj.anchor != null) {\r\n    anchor.x = 0\r\n    anchor.y = 0\r\n  }\r\n\r\n  return {\r\n    origin: {\r\n      x: position.x + body.width * anchor.x,\r\n      y: position.y + body.height * anchor.y\r\n    }\r\n  }\r\n}\r\n\r\nhandler.agent = function agent (nfov, obj) {\r\n  const agentObj = handler.basicObject(nfov, obj)\r\n\r\n  agentObj.distance = nfov.getDistance()\r\n  agentObj.direction = 0\r\n  agentObj.maxAngle = nfov.getAngle(nfov.RADIANS)\r\n\r\n  if (obj.distance != null) {\r\n    agentObj.distance = obj.distance\r\n  }\r\n\r\n  if (obj.direction != null) {\r\n    agentObj.direction = handler.parseAngle(obj.direction, nfov.getAngleUnit() === nfov.DEGREES, nfov.getOrientation() === nfov.CLOCKWISE)\r\n  } else if (obj.body != null && obj.body.rotation != null) {\r\n    // phaser\r\n    agentObj.direction = handler.parseAngle(obj.body.rotation, true, true)\r\n  } else if (obj.body != null && obj.body.angle != null) {\r\n    // phaser\r\n    agentObj.direction = handler.parseAngle(obj.body.angle, false, true)\r\n  } else if (obj.rotation != null) {\r\n    agentObj.direction = handler.parseAngle(obj.rotation, nfov.getAngleUnit() === nfov.DEGREES, nfov.getOrientation() === nfov.CLOCKWISE)\r\n  }\r\n\r\n  if (obj.maxAngle != null) {\r\n    agentObj.maxAngle = nfov.getAngleUnit() === nfov.DEGREES ? obj.maxAngle * Math.PI / 180 : obj.maxAngle\r\n  }\r\n\r\n  return agentObj\r\n}\r\n\r\nhandler.target = function target (nfov, obj) {\r\n  return handler.basicObject(nfov, obj)\r\n}\r\n\r\nhandler.angleDiff = function angleDiff (angle1, angle2) {\r\n  const halfCircle = Math.PI\r\n  const fullCircle = halfCircle * 2\r\n\r\n  let diff = angle1 - angle2\r\n  diff = diff % fullCircle\r\n\r\n  if (diff >= halfCircle) {\r\n    diff -= fullCircle\r\n  } else if (diff < -halfCircle) {\r\n    diff += fullCircle\r\n  }\r\n\r\n  return diff\r\n}\r\n\r\nhandler.makeRay = function makeRay (_agent, _target, tileSize) {\r\n  const agent = {\r\n    x: _agent.x / tileSize.width,\r\n    y: _agent.y / tileSize.height\r\n  }\r\n\r\n  const target = {\r\n    x: _target.x / tileSize.width,\r\n    y: _target.y / tileSize.height\r\n  }\r\n\r\n  const direction = {\r\n    x: target.x - agent.x,\r\n    y: target.y - agent.y\r\n  }\r\n\r\n  const delta = {\r\n    x: direction.x === 0 ? 0 : Math.abs(1 / direction.x),\r\n    y: direction.y === 0 ? 0 : Math.abs(1 / direction.y)\r\n  }\r\n\r\n  const over = {\r\n    x: agent.x - Math.floor(agent.x),\r\n    y: agent.y - Math.floor(agent.y)\r\n  }\r\n\r\n  const current = {\r\n    x: direction.x === 0 ? 2 : (direction.x > 0 ? 1 - over.x : over.x) * delta.x,\r\n    y: direction.y === 0 ? 2 : (direction.y > 0 ? 1 - over.y : over.y) * delta.y\r\n  }\r\n\r\n  const step = {\r\n    x: direction.x >= 0 ? 1 : -1,\r\n    y: direction.y >= 0 ? 1 : -1\r\n  }\r\n\r\n  const point = {\r\n    x: Math.floor(agent.x),\r\n    y: Math.floor(agent.y)\r\n  }\r\n\r\n  return {\r\n    next: function next () {\r\n      if (current.x > 1 && current.y > 1) {\r\n        return false\r\n      }\r\n\r\n      if (current.x <= current.y) {\r\n        current.x += delta.x\r\n        point.x += step.x\r\n      } else {\r\n        current.y += delta.y\r\n        point.y += step.y\r\n      }\r\n\r\n      return {\r\n        x: point.x,\r\n        y: point.y\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nhandler.targetInRange = function targetInRange (nfov, agent, target) {\r\n  if (agent.distance > 0) {\r\n    const dx = target.origin.x - agent.origin.x\r\n    const dy = agent.origin.y - target.origin.y\r\n    const distance = Math.sqrt(dx * dx + dy * dy)\r\n    return distance <= agent.distance\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\nhandler.targetInFOV = function targetInFOV (nfov, agent, target) {\r\n  const halfCircle = Math.PI\r\n  const fullCircle = halfCircle * 2\r\n\r\n  if (agent.maxAngle > 0 && agent.maxAngle < fullCircle) {\r\n    const angle2Target = Math.atan2(agent.origin.y - target.origin.y, target.origin.x - agent.origin.x)\r\n    const diff = handler.fixPrecision(handler.angleDiff(agent.direction, angle2Target))\r\n    const maxAngle = handler.fixPrecision(agent.maxAngle / 2)\r\n    return diff <= maxAngle && diff >= -maxAngle\r\n  } else {\r\n    return true\r\n  }\r\n}\r\n\r\nhandler.targetIsVisible = function targetIsVisible (nfov, agent, target) {\r\n  const grid = nfov.getGrid()\r\n\r\n  if (grid != null) {\r\n    const tileSize = nfov.getTileSize()\r\n    const acceptableTiles = nfov.getAcceptableTiles()\r\n\r\n    const rayCast = handler.makeRay(agent.origin, target.origin, tileSize)\r\n    let point = rayCast.next()\r\n\r\n    while (point) {\r\n      if (grid[point.y] != null && grid[point.y][point.x] != null) {\r\n        const tile = grid[point.y][point.x]\r\n\r\n        if (acceptableTiles.indexOf(tile) >= 0) {\r\n          point = rayCast.next()\r\n        } else {\r\n          return false\r\n        }\r\n      } else {\r\n        // tile not mapped\r\n        return false\r\n      }\r\n    }\r\n  }\r\n\r\n  return true\r\n}\r\n\r\nmodule.exports = handler\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/handlers/basic.js","const basicHandler = require('./handlers/basic')\r\n\r\nfunction nfov (config) {\r\n  if (!(this instanceof nfov)) {\r\n    throw new Error('Constructor called as a function')\r\n  }\r\n\r\n  config = Object.assign({\r\n    distance: 0,\r\n    angle: 0,\r\n    angleUnit: nfov.RADIANS,\r\n    orientation: nfov.COUNTERCLOCKWISE,\r\n    grid: null,\r\n    tileSize: {\r\n      width: 1,\r\n      height: 1\r\n    },\r\n    acceptableTiles: [],\r\n    handler: basicHandler\r\n  }, config)\r\n\r\n  this.setDistance(config.distance)\r\n  this.setAngle(config.angle)\r\n  this.setAngleUnit(config.angleUnit)\r\n  this.setOrientation(config.orientation)\r\n  this.setGrid(config.grid)\r\n  this.setTileSize(config.tileSize)\r\n  this.setAcceptableTiles(config.acceptableTiles)\r\n  this.setHandler(config.handler)\r\n}\r\n\r\nnfov.RADIANS = nfov.prototype.RADIANS = 1\r\nnfov.DEGREES = nfov.prototype.DEGREES = 2\r\n\r\nnfov.CLOCKWISE = nfov.prototype.CLOCKWISE = 1\r\nnfov.COUNTERCLOCKWISE = nfov.prototype.COUNTERCLOCKWISE = 2\r\n\r\nnfov.prototype.setDistance = function setDistance (distance) {\r\n  if (typeof distance === 'number' && distance >= 0) {\r\n    this.distance = distance\r\n  } else {\r\n    throw new Error('Invalid value passed for `distance`')\r\n  }\r\n}\r\n\r\nnfov.prototype.getDistance = function getDistance () {\r\n  return this.distance\r\n}\r\n\r\nnfov.prototype.setAngle = function setAngle (angle) {\r\n  if (typeof angle === 'number' && angle >= 0) {\r\n    this.angle = angle\r\n  } else {\r\n    throw new Error('Invalid value passed for `angle`')\r\n  }\r\n}\r\n\r\nnfov.prototype.getAngle = function getAngle (unit) {\r\n  if (unit === nfov.RADIANS) {\r\n    if (this.getAngleUnit() === nfov.DEGREES) {\r\n      return this.angle * Math.PI / 180\r\n    }\r\n  } else if (unit === nfov.DEGREES) {\r\n    if (this.getAngleUnit() === nfov.RADIANS) {\r\n      return this.angle * 180 / Math.PI\r\n    }\r\n  }\r\n\r\n  return this.angle\r\n}\r\n\r\nnfov.prototype.setAngleUnit = function setAngleUnit (angleUnit) {\r\n  if (angleUnit === nfov.RADIANS) {\r\n    this.angleUnit = nfov.RADIANS\r\n  } else if (angleUnit === nfov.DEGREES) {\r\n    this.angleUnit = nfov.DEGREES\r\n  } else {\r\n    throw new Error('Invalid value passed for `angleUnit`')\r\n  }\r\n}\r\n\r\nnfov.prototype.getAngleUnit = function getAngleUnit () {\r\n  return this.angleUnit\r\n}\r\n\r\nnfov.prototype.setOrientation = function setOrientation (orientation) {\r\n  if (orientation === nfov.CLOCKWISE) {\r\n    this.orientation = nfov.CLOCKWISE\r\n  } else if (orientation === nfov.COUNTERCLOCKWISE) {\r\n    this.orientation = nfov.COUNTERCLOCKWISE\r\n  } else {\r\n    throw new Error('Invalid value passed for `orientation`')\r\n  }\r\n}\r\n\r\nnfov.prototype.getOrientation = function getOrientation () {\r\n  return this.orientation\r\n}\r\n\r\nnfov.prototype.setGrid = function setGrid (grid) {\r\n  if (grid == null || Array.isArray(grid)) {\r\n    this.grid = grid\r\n  } else {\r\n    throw new Error('Invalid value passed for `grid`')\r\n  }\r\n}\r\n\r\nnfov.prototype.getGrid = function getGrid () {\r\n  return this.grid\r\n}\r\n\r\nnfov.prototype.setTileSize = function setTileSize (widthOrObj, height) {\r\n  if (widthOrObj > 0) {\r\n    this.tileSize = {\r\n      width: widthOrObj,\r\n      height: height > 0 ? height : widthOrObj\r\n    }\r\n  } else if (widthOrObj != null && widthOrObj.width > 0 && widthOrObj.height > 0) {\r\n    this.tileSize = {\r\n      width: widthOrObj.width,\r\n      height: widthOrObj.height\r\n    }\r\n  } else {\r\n    throw new Error('Invalid value passed for `tileSize`')\r\n  }\r\n}\r\n\r\nnfov.prototype.getTileSize = function getTileSize () {\r\n  return this.tileSize\r\n}\r\n\r\nnfov.prototype.setAcceptableTiles = function setAcceptableTiles (tiles) {\r\n  if (Array.isArray(tiles)) {\r\n    this.acceptableTiles = tiles.slice(0)\r\n  } else if (tiles != null) {\r\n    this.acceptableTiles = [tiles]\r\n  } else {\r\n    throw new Error('Invalid value passed for `tiles`')\r\n  }\r\n}\r\n\r\nnfov.prototype.getAcceptableTiles = function getAcceptableTiles () {\r\n  return this.acceptableTiles\r\n}\r\n\r\nnfov.prototype.setHandler = function setHandler (handler) {\r\n  if (typeof handler === 'function') {\r\n    this.handler = handler\r\n  } else {\r\n    throw new Error('Invalid value passed for `handler`')\r\n  }\r\n}\r\n\r\nnfov.prototype.getHandler = function getHandler () {\r\n  return this.handler\r\n}\r\n\r\nnfov.prototype.detect = function detect (agents, targets, callback) {\r\n  const handler = this.getHandler()\r\n  handler(this, agents, targets, callback)\r\n}\r\n\r\nmodule.exports = nfov\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}